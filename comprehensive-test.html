<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Test Results</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .pass { background: #d4edda; border: 1px solid #c3e6cb; }
        .fail { background: #f8d7da; border: 1px solid #f5c6cb; }
        .error { background: #fff3cd; border: 1px solid #ffeaa7; }
        .summary { background: #e2e3e5; padding: 15px; border-radius: 5px; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>Comprehensive Test Results</h1>
    <div id="summary" class="summary">Running tests...</div>
    <div id="results"></div>

    <!-- Hidden DOM elements needed for tests -->
    <div id="conway-controls" class="simulation-controls" style="display: none;">
        <div class="control-group">
            <label for="conway-speed">Speed:</label>
            <input type="range" id="conway-speed" min="1" max="30" value="10">
            <span id="conway-speed-value">10</span>
        </div>
    </div>
    
    <div id="termite-controls" class="simulation-controls" style="display: none;">
        <div class="control-group">
            <label for="termite-speed">Speed:</label>
            <input type="range" id="termite-speed" min="1" max="30" value="10">
            <span id="termite-speed-value">10</span>
        </div>
    </div>
    
    <div id="langton-controls" class="simulation-controls" style="display: none;">
        <div class="control-group">
            <label for="langton-speed">Speed:</label>
            <input type="range" id="langton-speed" min="1" max="30" value="10">
            <span id="langton-speed-value">10</span>
        </div>
    </div>
    
    <div id="termites-container" style="display: none;">
        <div class="control-group">
            <label for="termite-count">Termite Count:</label>
            <input type="range" id="termite-count" min="1" max="50" value="10">
            <span id="termite-count-value">10</span>
        </div>
    </div>
    
    <!-- Action buttons needed for tests -->
    <button id="random-btn" style="display: none;">Random Pattern</button>
    <button id="termite-random-btn" style="display: none;">Random Termites</button>
    <button id="langton-random-btn" style="display: none;">Random Ants</button>
    <button id="add-ant-btn" style="display: none;">Add Ant</button>
    
    <!-- Modal elements needed for tests -->
    <div id="conway-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2>Conway's Game of Life</h2>
            <p>Educational content about Conway's Game of Life.</p>
        </div>
    </div>
    
    <div id="termite-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2>Termite Algorithm</h2>
            <p>Educational content about the Termite Algorithm.</p>
        </div>
    </div>
    
    <div id="langton-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2>Langton's Ant</h2>
            <p>Educational content about Langton's Ant.</p>
        </div>
    </div>

    <script src="i18n.js"></script>
    <script src="simulations.js"></script>
    <script src="app.js"></script>
    
    <script>
        const testResults = {
            total: 0,
            passed: 0,
            failed: 0,
            errors: 0
        };
        
        function addTestResult(testName, passed, details = '', error = null) {
            testResults.total++;
            if (error) {
                testResults.errors++;
            } else if (passed) {
                testResults.passed++;
            } else {
                testResults.failed++;
            }
            
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${error ? 'error' : (passed ? 'pass' : 'fail')}`;
            
            const status = error ? 'üí• ERROR' : (passed ? '‚úÖ PASS' : '‚ùå FAIL');
            resultDiv.innerHTML = `
                <strong>${status}: ${testName}</strong><br>
                <small>${details}</small>
                ${error ? `<br><small style="color: red;">Error: ${error}</small>` : ''}
            `;
            
            document.getElementById('results').appendChild(resultDiv);
            
            // Update summary
            const summary = document.getElementById('summary');
            summary.innerHTML = `
                <h3>Test Summary</h3>
                <p>Total: ${testResults.total} | Passed: ${testResults.passed} | Failed: ${testResults.failed} | Errors: ${testResults.errors}</p>
                <p>Success Rate: ${((testResults.passed / testResults.total) * 100).toFixed(1)}%</p>
            `;
        }
        
        async function runTests() {
            console.log('üöÄ Starting comprehensive test run...');
            
            // Test 1: Basic class availability
            try {
                const classesAvailable = typeof ConwayGameOfLife !== 'undefined' && 
                                       typeof TermiteAlgorithm !== 'undefined' && 
                                       typeof LangtonsAnt !== 'undefined' &&
                                       typeof SimulationFactory !== 'undefined';
                addTestResult('Basic Classes Available', classesAvailable, 
                             classesAvailable ? 'All required classes found' : 'Some classes missing');
            } catch (e) {
                addTestResult('Basic Classes Available', false, '', e.message);
            }
            
            // Test 2: ConfigurationManager
            try {
                const configs = ConfigurationManager.getAllConfigs();
                const hasConfigs = configs && Object.keys(configs).length > 0;
                addTestResult('ConfigurationManager', hasConfigs, 
                             hasConfigs ? `Found ${Object.keys(configs).length} configs` : 'No configs found');
            } catch (e) {
                addTestResult('ConfigurationManager', false, '', e.message);
            }
            
            // Test 3: AlgorithmicPatternGenerator
            try {
                const app = new AlgorithmicPatternGenerator();
                addTestResult('AlgorithmicPatternGenerator Creation', app !== null, 'App created successfully');
            } catch (e) {
                addTestResult('AlgorithmicPatternGenerator Creation', false, '', e.message);
            }
            
            // Test 4: Conway Game of Life Creation
            try {
                const canvas = document.createElement('canvas');
                canvas.width = 400;
                canvas.height = 300;
                const ctx = canvas.getContext('2d');
                
                const simulation = new ConwayGameOfLife(canvas, ctx);
                addTestResult('Conway Game of Life Creation', simulation instanceof ConwayGameOfLife, 
                             'Conway simulation created successfully');
            } catch (e) {
                addTestResult('Conway Game of Life Creation', false, '', e.message);
            }
            
            // Test 5: Conway Grid Initialization
            try {
                const canvas = document.createElement('canvas');
                canvas.width = 400;
                canvas.height = 300;
                const ctx = canvas.getContext('2d');
                
                const simulation = new ConwayGameOfLife(canvas, ctx);
                simulation.init();
                
                const hasGrids = simulation.grids && simulation.grids.current && simulation.grids.next;
                addTestResult('Conway Grid Initialization', hasGrids, 
                             hasGrids ? `Grid dimensions: ${simulation.rows}x${simulation.cols}` : 'Grids not created');
            } catch (e) {
                addTestResult('Conway Grid Initialization', false, '', e.message);
            }
            
            // Test 6: Conway Cell Toggle
            try {
                const canvas = document.createElement('canvas');
                canvas.width = 400;
                canvas.height = 300;
                const ctx = canvas.getContext('2d');
                
                const simulation = new ConwayGameOfLife(canvas, ctx);
                simulation.init();
                
                const initialCount = simulation.cellCount;
                simulation.toggleCell(50, 50);
                const afterToggleCount = simulation.cellCount;
                
                const countChanged = afterToggleCount !== initialCount;
                addTestResult('Conway Cell Toggle', countChanged, 
                             countChanged ? `Cell count changed from ${initialCount} to ${afterToggleCount}` : 'Cell count unchanged');
            } catch (e) {
                addTestResult('Conway Cell Toggle', false, '', e.message);
            }
            
            // Test 7: Termite Algorithm Creation
            try {
                const canvas = document.createElement('canvas');
                canvas.width = 400;
                canvas.height = 300;
                const ctx = canvas.getContext('2d');
                
                const simulation = new TermiteAlgorithm(canvas, ctx);
                addTestResult('Termite Algorithm Creation', simulation instanceof TermiteAlgorithm, 
                             'Termite simulation created successfully');
            } catch (e) {
                addTestResult('Termite Algorithm Creation', false, '', e.message);
            }
            
            // Test 8: Langton's Ant Creation
            try {
                const canvas = document.createElement('canvas');
                canvas.width = 400;
                canvas.height = 300;
                const ctx = canvas.getContext('2d');
                
                const simulation = new LangtonsAnt(canvas, ctx);
                addTestResult('Langton\'s Ant Creation', simulation instanceof LangtonsAnt, 
                             'Langton simulation created successfully');
            } catch (e) {
                addTestResult('Langton\'s Ant Creation', false, '', e.message);
            }
            
            // Test 9: Simulation Factory
            try {
                const canvas = document.createElement('canvas');
                canvas.width = 400;
                canvas.height = 300;
                const ctx = canvas.getContext('2d');
                
                const conwaySim = SimulationFactory.createSimulation('conway', canvas, ctx);
                const termiteSim = SimulationFactory.createSimulation('termite', canvas, ctx);
                const langtonSim = SimulationFactory.createSimulation('langton', canvas, ctx);
                
                const factoryWorks = conwaySim instanceof ConwayGameOfLife && 
                                   termiteSim instanceof TermiteAlgorithm && 
                                   langtonSim instanceof LangtonsAnt;
                
                addTestResult('Simulation Factory', factoryWorks, 
                             factoryWorks ? 'All simulation types created successfully' : 'Some simulations failed');
            } catch (e) {
                addTestResult('Simulation Factory', false, '', e.message);
            }
            
            // Test 10: Control Manager
            try {
                const controlManager = new ControlManager();
                controlManager.showControls('conway');
                
                const controlsWork = controlManager.activeControls === 'conway';
                addTestResult('Control Manager', controlsWork, 
                             controlsWork ? 'Control manager working correctly' : 'Control manager failed');
            } catch (e) {
                addTestResult('Control Manager', false, '', e.message);
            }
            
            // Test 11: Initial Controls Visibility
            try {
                const app = new AlgorithmicPatternGenerator();
                app.init();
                
                const conwayControls = document.getElementById('conway-controls');
                const isVisible = conwayControls && conwayControls.style.display === 'flex';
                
                addTestResult('Initial Controls Visibility', isVisible, 
                             isVisible ? 'Controls visible after init' : 'Controls not visible after init');
            } catch (e) {
                addTestResult('Initial Controls Visibility', false, '', e.message);
            }
            
            // Test 12: Performance Optimizer
            try {
                const debounced = PerformanceOptimizer.debounce(() => {}, 100);
                const throttled = PerformanceOptimizer.throttle(() => {}, 100);
                
                const optimizerWorks = typeof debounced === 'function' && typeof throttled === 'function';
                addTestResult('Performance Optimizer', optimizerWorks, 
                             optimizerWorks ? 'Debounce and throttle functions created' : 'Performance optimizer failed');
            } catch (e) {
                addTestResult('Performance Optimizer', false, '', e.message);
            }
            
            console.log('‚úÖ Comprehensive test run completed!');
            console.log(`üìä Results: ${testResults.passed}/${testResults.total} passed (${((testResults.passed / testResults.total) * 100).toFixed(1)}%)`);
        }
        
        // Run tests when page loads
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html> 