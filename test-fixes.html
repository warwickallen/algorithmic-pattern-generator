<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Fixes</title>
</head>
<body>
    <h1>Test Fixes</h1>
    <div id="results"></div>
    
    <script src="i18n.js"></script>
    <script src="simulations.js"></script>
    <script src="app.js"></script>
    
    <script>
        function log(message) {
            const results = document.getElementById('results');
            results.innerHTML += '<div>' + message + '</div>';
        }
        
        async function runTests() {
            log('Starting tests...');
            
            // Test 1: Canvas Configuration
            const canvas = document.createElement('canvas');
            canvas.width = 400;
            canvas.height = 300;
            const ctx = canvas.getContext('2d');
            
            const simulation = new ConwayGameOfLife(canvas, ctx);
            simulation.init();
            
            log(`Canvas dimensions after init: ${canvas.width}x${canvas.height}`);
            log(`Valid dimensions: ${canvas.width > 0 && canvas.height > 0}`);
            log(`Reasonable dimensions: ${canvas.width >= 400 && canvas.height >= 300}`);
            
            // Test 2: Fade Progression
            simulation.setFadeOutCycles(3);
            simulation.generation = 1;
            
            // Clear the initialInactiveCells set to allow fade data creation
            simulation.initialInactiveCells = new Set();
            
            // Create a cell, then make it inactive
            simulation.toggleCell(5, 5);
            simulation.updateFadeStates(simulation.grids.current);
            
            simulation.toggleCell(5, 5);
            simulation.updateFadeStates(simulation.grids.current);
            const fadeCycle1 = simulation.getCellFadeFactor(5, 5, false);
            
            const cellKey = '5,5';
            const fadeData = simulation.cellFadeStates.get(cellKey);
            const fadeCount1 = fadeData ? fadeData.fadeCount : 'no data';
            
            simulation.generation = 2;
            simulation.updateFadeStates(simulation.grids.current);
            const fadeCycle2 = simulation.getCellFadeFactor(5, 5, false);
            
            const fadeData2 = simulation.cellFadeStates.get(cellKey);
            const fadeCount2 = fadeData2 ? fadeData2.fadeCount : 'no data';
            
            log(`Fade test: Generation 1: fadeCount=${fadeCount1}, fadeFactor=${fadeCycle1.toFixed(3)}`);
            log(`Fade test: Generation 2: fadeCount=${fadeCount2}, fadeFactor=${fadeCycle2.toFixed(3)}`);
            log(`Fade progression: ${fadeCycle2 < fadeCycle1}`);
            
            log('Tests completed!');
        }
        
        runTests();
    </script>
</body>
</html> 