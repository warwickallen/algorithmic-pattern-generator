<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Algorithmic Pattern Generator</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link rel="stylesheet" href="styles.css" />
    <script src="../src/constants.js"></script>
    <script src="../src/logger.js"></script>
    <script src="../src/type-guards.js"></script>
    <script src="../src/types.js"></script>
    <script src="../src/config-validator.js"></script>
    <script src="../src/dynamic-layout.js"></script>
    <script src="../src/resource-manager.js"></script>
    <script src="../src/animation-manager.js"></script>
    <script src="../src/statistics-collector.js"></script>
    <script src="../src/canvas-manager.js"></script>
    <script src="../src/keyboard-shortcut-manager.js"></script>
  </head>
  <body>
    <div id="app">
      <!-- Title (top-left, no border/background) -->
      <div
        id="title-container"
        class="control-group top-left control-group--transparent"
      >
        <h1 id="title" class="gradient-text">Algorithmic Pattern Generator</h1>
      </div>

      <!-- Simulation selector (top) -->
      <div
        id="simulation-container"
        class="control-group control-panel dynamic-position glass-light hover-lift"
      >
        <div class="simulation-selector flex-center gap-sm">
          <label for="simulation-select" id="simulation-label"
            >Simulation:</label
          >
          <select id="simulation-select">
            <option value="conway" id="conway-option">
              Conway's Game of Life
            </option>
            <option value="termite" id="termite-option">
              Termite Algorithm
            </option>
            <option value="langton" id="langton-option">Langton's Ant</option>
            <option value="reaction" id="reaction-option">
              Reaction–Diffusion
            </option>
          </select>
        </div>
      </div>

      <!-- Start/Pause and Speed controls (top) -->
      <div
        id="playback-container"
        class="control-group control-panel dynamic-position glass-light hover-lift"
      >
        <button id="start-pause-btn" class="btn primary hover-lift">
          Start
        </button>

        <!-- Speed Control -->
        <div class="speed-control flex-center gap-lg">
          <div class="control-group control-group--static">
            <label for="dynamic-speed-slider">Speed:</label>
            <input
              type="range"
              id="dynamic-speed-slider"
              min="1"
              max="60"
              value="30"
              class="slider"
              data-constants="AppConstants.UISliders.SPEED"
            />
            <span id="dynamic-speed-value">30 steps/s</span>
          </div>
        </div>

        <!-- Conway's Game of Life specific controls -->
        <div
          id="conway-controls"
          class="simulation-controls flex-center gap-lg"
          data-simulation="conway"
          style="display: none"
        >
          <!-- Speed control moved to dynamic container -->
        </div>

        <!-- Termite Algorithm specific controls -->
        <div
          id="termite-controls"
          class="simulation-controls flex-center gap-lg"
          data-simulation="termite"
          style="display: none"
        >
          <!-- Speed control moved to dynamic container -->
        </div>

        <!-- Langton's Ant specific controls -->
        <div
          id="langton-controls"
          class="simulation-controls flex-center gap-lg"
          data-simulation="langton"
          style="display: none"
        >
          <!-- Speed control moved to dynamic container -->
        </div>

        <!-- Reaction–Diffusion specific controls -->
        <div
          id="reaction-controls"
          class="simulation-controls flex-center gap-lg"
          data-simulation="reaction"
          style="display: none"
        >
          <div class="control-group control-group--static">
            <label for="reaction-feed-slider">Feed (F):</label>
            <input
              type="range"
              id="reaction-feed-slider"
              min="0"
              max="0.1"
              step="0.001"
              value="0.06"
              class="slider"
            />
            <span id="reaction-feed-value">0.060</span>
          </div>
          <div class="control-group control-group--static">
            <label for="reaction-kill-slider">Kill (k):</label>
            <input
              type="range"
              id="reaction-kill-slider"
              min="0"
              max="0.1"
              step="0.001"
              value="0.062"
              class="slider"
            />
            <span id="reaction-kill-value">0.062</span>
          </div>
        </div>
      </div>

      <!-- Reset, Random buttons and likelihood slider (top) -->
      <div
        id="action-container"
        class="control-group control-panel dynamic-position glass-light hover-lift"
      >
        <button id="reset-btn" class="btn secondary hover-lift">Reset</button>

        <!-- Likelihood Control -->
        <div class="likelihood-control flex-center gap-lg">
          <div class="control-group control-group--static">
            <label for="likelihood-slider">Coverage:</label>
            <input
              type="range"
              id="likelihood-slider"
              min="0"
              max="100"
              value="30"
              class="slider"
              data-constants="AppConstants.UISliders.LIKELIHOOD"
            />
            <span id="likelihood-value">30%</span>
          </div>
        </div>

        <!-- Dynamic Fill Button - replaces individual random buttons -->
        <button
          id="dynamic-fill-btn"
          class="btn secondary hover-lift"
          style="display: none"
        >
          Fill
        </button>
      </div>

      <!-- Termites Control (top) -->
      <div
        id="termites-container"
        class="control-group control-panel dynamic-position glass-light hover-lift"
        data-simulation="termite"
        style="display: none"
      >
        <div class="control-group control-group--static">
          <label for="termites-slider">Termites:</label>
          <input
            type="range"
            id="termites-slider"
            min="1"
            max="100"
            value="50"
            class="slider"
            data-constants="AppConstants.UISliders.TERMITES"
          />
          <span id="termites-value">50</span>
        </div>
      </div>

      <!-- Ants Control (top) -->
      <div
        id="ants-container"
        class="control-group control-panel dynamic-position glass-light hover-lift"
        data-simulation="langton"
        style="display: none"
      >
        <div class="control-group control-group--static">
          <label for="ants-slider">Ants:</label>
          <input
            type="range"
            id="ants-slider"
            min="1"
            max="100"
            value="1"
            class="slider"
          />
          <span id="ants-value">1</span>
        </div>
      </div>

      <!-- Immersive Mode and Brightness controls (top) -->
      <div
        id="display-container"
        class="control-group control-panel dynamic-position glass-light hover-lift"
      >
        <button id="immersive-btn" class="btn secondary hover-lift">
          Immersive Mode
        </button>

        <!-- Brightness Control -->
        <div class="brightness-control flex-center gap-lg">
          <div class="control-group control-group--static">
            <label for="brightness-slider">Brightness:</label>
            <input
              type="range"
              id="brightness-slider"
              min="0.1"
              max="2.0"
              step="0.1"
              value="1.0"
              class="slider"
              data-constants="AppConstants.UISliders.BRIGHTNESS"
            />
            <span id="brightness-value">100%</span>
          </div>
        </div>
      </div>

      <!-- Learn button (top-right) -->
      <div
        id="learn-container"
        class="control-group top-right control-group--transparent"
      >
        <button
          id="learn-btn"
          class="btn secondary hover-lift"
          style="display: none"
          data-i18n-key="learn-btn"
          data-i18n-attr="title:tooltip-learn,aria-label:tooltip-learn"
        >
          Learn
        </button>
      </div>

      <!-- Generation and Cells display (bottom-left) -->
      <div
        id="stats-container"
        class="control-group control-panel bottom-left glass-light hover-lift"
      >
        <div class="status-info flex-center gap-sm">
          <span id="generation-label">Generation:</span>
          <span id="generation-count">0</span>
          <span id="cell-count-label">Cells:</span>
          <span id="cell-count">0</span>
          <span id="grid-size-label">Grid:</span>
          <span id="grid-size">0 × 0</span>
          <span id="canvas-size-label">Canvas:</span>
          <span id="canvas-size">0 × 0</span>
        </div>
      </div>

      <!-- FPS display (bottom-right) -->
      <div
        id="fps-container"
        class="control-group control-panel bottom-right glass-light hover-lift"
      >
        <div class="status-info flex-center gap-sm">
          <span id="fps-label" data-i18n-key="fps-label">FPS:</span>
          <span id="fps">0</span>
        </div>
      </div>

      <!-- Canvas container -->
      <main id="main" class="position-absolute">
        <canvas id="canvas" class="position-absolute gpu-accelerate"></canvas>
      </main>
    </div>

    <!-- Immersive mode exit hint -->
    <div id="immersive-hint" class="immersive-hint glass">
      <span>Press <kbd>Escape</kbd> to exit immersive mode</span>
    </div>

    <!-- Dynamic Learn Modal -->
    <div id="dynamic-modal" class="modal">
      <div class="modal-content glass">
        <div class="modal-header flex-center">
          <h2 data-modal-title class="gradient-text">Simulation Information</h2>
          <button class="modal-close hover-lift" id="dynamic-modal-close">
            &times;
          </button>
        </div>
        <div class="modal-body" data-modal-content>
          <!-- Content will be dynamically injected here -->
        </div>
      </div>
    </div>

    <script src="../src/i18n.js"></script>
    <script src="../src/utils.js"></script>
    <script src="../src/actors.js"></script>
    <!-- Core & Plug-in Registry (iteration 1: loaded alongside legacy monolith) -->
    <script src="../src/core/error-handler.js"></script>
    <script src="../src/core/lifecycle.js"></script>
    <script src="../src/core/rendering-utils.js"></script>
    <script src="../src/simulations/base-simulation.js"></script>
    <script src="../src/simulations/registry.js"></script>
    <!-- Simulation plug-ins self-register at load -->
    <script src="../src/simulations/conway.js"></script>
    <script src="../src/simulations/termite.js"></script>
    <script src="../src/simulations/langton.js"></script>
    <script src="../src/simulations/reaction.js"></script>
    <!-- Legacy monolith kept for constructors & shimmed factory during transition -->
    <script src="../src/simulations.js"></script>
    <script src="../src/simulations/factory-shim.js"></script>
    <script src="../src/app.js"></script>
  </body>
</html>
